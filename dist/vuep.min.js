!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue/dist/vue.common")):"function"==typeof define&&define.amd?define(["exports","vue/dist/vue.common"],t):t(e.Vuep=e.Vuep||{},e.Vue)}(this,function(e,t){"use strict";function r(e,t){var r=/(^|\})\s*([^{]+)/g;return e.trim().replace(r,function(e,r,i){return r?r+" "+t+" "+i:t+" "+i})}function i(e,t){d.config(t),e.component(d.name,d)}t="default"in t?t.default:t;var o=function(e){for(var t=arguments,r=1;r<arguments.length;r++){var i=t[r];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},s=Object.assign||o,n={lineNumbers:!0,mode:"text/x-vue",theme:"material",tabSize:2},a={name:"VueCodeMirror",props:["value","options"],render:function(e){return e("div",null,[e("textarea",{ref:"textarea"},this.value)])},mounted:function(){this.currentOptions=s({},n,this.options);var e=require("codemirror");require("codemirror/addon/mode/overlay"),require("codemirror/addon/mode/simple"),require("codemirror/mode/css/css"),require("codemirror/mode/htmlmixed/htmlmixed"),require("codemirror/mode/javascript/javascript"),require("codemirror/mode/vue/vue"),require("codemirror/mode/xml/xml"),require("codemirror/mode/jsx/jsx"),this.editor=e.fromTextArea(this.$refs.textarea,this.currentOptions),this.editor.on("change",this.handleChange)},watch:{value:function(e){e!==this.editor.getValue()&&this.editor.setValue(e)}},methods:{handleChange:function(){this.$emit("change",this.editor.getValue())}}},u={name:"preview",props:["value","styles","keepData"],render:function(e){return this.className="vuep-scoped-"+this._uid,e("div",{class:this.className},[this.scopedStyle?e("style",null,this.scopedStyle):""])},computed:{scopedStyle:function(){return this.styles?r(this.styles,"."+this.className):""}},mounted:function(){this.$watch("value",this.renderCode,{immediate:!0})},methods:{renderCode:function(e){var r=this,i=this.keepData&&this.codeVM&&s({},this.codeVM.$data);this.codeVM&&(this.codeVM.$destroy(),this.$el.removeChild(this.codeVM.$el)),this.codeEl=document.createElement("div"),this.$el.appendChild(this.codeEl);try{var o=this;if(this.codeVM=new t(s({},{parent:o},e)).$mount(this.codeEl),i)for(var n in i)r.codeVM[n]=i[n]}catch(e){this.$emit("error",e)}}}},c=function(e){var t=document.createElement("div"),r=t.innerHTML=e.trim();try{var i=t.querySelector("template"),o=t.querySelector("script"),s=Array.prototype.slice.call(t.querySelectorAll("style")).map(function(e){return e.innerHTML});return i||o||s.length?{content:/<\/script>$/g.test(r)?r:r+"\n<\/script>",template:i?i.innerHTML:"",script:o?o.innerHTML:"",styles:s}:{content:r,script:r}}catch(e){return{error:e}}},d={name:"Vuep",props:{template:String,options:{},keepData:Boolean,value:String,scope:Object},data:function(){return{content:"",preview:"",styles:"",error:""}},render:function(e){var t,r=this;return t=this.error?e("div",{class:"vuep-error"},[this.error]):e(u,{class:"vuep-preview",props:{value:this.preview,styles:this.styles,keepData:this.keepData},on:{error:this.handleError}}),e("div",{class:"vuep"},[e(a,{class:"vuep-editor",props:{value:this.content,options:this.options},on:{change:[this.executeCode,function(e){return r.$emit("input",e)}]}}),t])},watch:{value:{immediate:!0,handler:function(e){e&&this.executeCode(e)}}},created:function(){if(!this.$isServer){var e=this.template;if(/^[\.#]/.test(this.template)){var t=document.querySelector(this.template);if(!t)throw Error(this.template+" is not found");e=t.innerHTML}e&&(this.executeCode(e),this.$emit("input",e))}},methods:{handleError:function(e){this.error=e},executeCode:function(e){this.error="";var t=c(e);if(t.error)return void(this.error=t.error.message);var r=require("../src/utils/compiler.js").default,i=r(t,this.scope);if(i.error)return void(this.error=i.error.message);this.content=t.content,this.preview=i.result,i.styles&&(this.styles=i.styles)}}};d.config=function(e){d.props.options.default=function(){return e}},d.install=i,"undefined"!=typeof Vue&&Vue.use(i),Object.defineProperty(e,"__esModule",{value:!0})});
